<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DictaMed - Dict√©e M√©dicale Intelligente</title>
    <link rel="stylesheet" href="style-optimized.css">
    <link rel="icon" type="image/png" sizes="32x32" href="icon-72x72.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icon-72x72.png">
    
    <!-- CSS de Fallback - S'active si style-optimized.css ne se charge pas -->
    <link rel="stylesheet" href="style-fallback.css">
</head>
<body>
    <!-- Navigation fixez horizontale en header -->
    <header class="fixed-nav-header" id="fixedNavHeader">
        <div class="fixed-nav-container">
            <div class="nav-logo-left">
                <div class="header-logo">
                    <span class="logo-dicta">Dicta</span><span class="logo-med">Med</span>
                </div>
            </div>
            <nav class="nav-tabs-right" aria-label="Navigation principale">
                <button class="fixed-nav-btn active" data-tab="home" aria-label="Page d'accueil">
                    <span class="nav-icon">üè†</span>
                    Accueil
                </button>
                <button class="fixed-nav-btn" data-tab="mode-normal" aria-label="Mode normal">
                    <span class="nav-icon">üè•</span>
                    Mode Normal
                </button>
                <button class="fixed-nav-btn" data-tab="mode-test" aria-label="Mode test">
                    <span class="nav-icon">üß™</span>
                    Mode Test
                </button>
                <button class="fixed-nav-btn" data-tab="mode-dmi" aria-label="Mode DMI">
                    <span class="nav-icon">üìù</span>
                    mode DMI
                </button>
                <button class="fixed-nav-btn" data-tab="guide" aria-label="Guide d'utilisation">
                    <span class="nav-icon">üìñ</span>
                    Guide
                </button>
                <button class="fixed-nav-btn" data-tab="faq" aria-label="Questions fr√©quentes">
                    <span class="nav-icon">‚ùì</span>
                    FAQ
                </button>
                <button class="fixed-nav-btn admin-nav-btn" id="adminNavBtn" style="display: none;" onclick="window.open('admin-webhooks.html', '_blank')" aria-label="Administration">
                    <span class="nav-icon">üéõÔ∏è</span>
                    Admin
                </button>
                <button class="fixed-nav-btn auth-btn" id="authButton" aria-label="Authentification">
                    <span class="nav-icon">üîê</span>
                    <span id="authButtonText">Connexion</span>
                </button>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Navigation par onglets originale (maintenant cach√©e) -->
        <nav class="tabs-nav" style="display: none;" aria-label="Navigation par onglets">
            <div class="tabs-container">
                <button class="tab-btn active" data-tab="home" aria-label="Page d'accueil">
                    <span class="tab-icon">üè†</span>
                    Accueil
                </button>
                <button class="tab-btn" data-tab="mode-normal" aria-label="Mode normal">
                    <span class="tab-icon">üè•</span>
                    Mode Normal
                </button>
                <button class="tab-btn" data-tab="mode-test" aria-label="Mode test">
                    <span class="tab-icon">üß™</span>
                    Mode Test
                </button>
                <button class="tab-btn" data-tab="mode-dmi" aria-label="Mode DMI">
                    <span class="tab-icon">üìù</span>
                    mode DMI
                </button>
                <button class="tab-btn" data-tab="guide" aria-label="Guide d'utilisation">
                    <span class="tab-icon">üìñ</span>
                    Guide
                </button>
                <button class="tab-btn" data-tab="faq" aria-label="Questions fr√©quentes">
                    <span class="tab-icon">‚ùì</span>
                    FAQ
                </button>
            </div>
            <div class="swipe-hint">‚Üê Glissez pour naviguer ‚Üí</div>
        </nav>

        <!-- Page d'accueil -->
        <section id="tab-content" class="tab-content active" role="main">
            <div class="hero-section-modern">
                <div class="hero-content-modern">
                    <h1 class="hero-title" role="heading" aria-level="1">
                        <span class="logo-dicta">Dicta</span><span class="logo-med">Med</span>
                    </h1>
                    <p class="hero-subtitle" role="doc-subtitle">
                        Dict√©e m√©dicale intelligente nouvelle g√©n√©ration
                    </p>
                    <p class="hero-description">
                        R√©volutionnez votre pratique m√©dicale avec notre IA avanc√©e. 
                        Transformez vos paroles en documents m√©dicaux structur√©s, s√©curis√©s et conformes.
                    </p>
                    
                    <div class="hero-cta" role="group" aria-label="Actions principales">
                        <button class="btn btn-primary btn-large" data-tab="mode-test" aria-label="Commencer maintenant">
                            <span class="btn-icon" aria-hidden="true">üöÄ</span>
                            Commencer maintenant
                        </button>
                        <button class="btn btn-secondary btn-large" data-tab="guide" aria-label="Voir la d√©monstration">
                            <span class="btn-icon" aria-hidden="true">üìã</span>
                            Voir la d√©mo
                        </button>
                    </div>
                    
                    <div class="hero-features-preview" role="list" aria-label="Fonctionnalit√©s principales">
                        <div class="preview-item" role="listitem">
                            <span class="preview-icon" aria-hidden="true">‚ö°</span>
                            <span>Instantan√©</span>
                        </div>
                        <div class="preview-item" role="listitem">
                            <span class="preview-icon" aria-hidden="true">üîí</span>
                            <span>S√©curis√©</span>
                        </div>
                        <div class="preview-item" role="listitem">
                            <span class="preview-icon" aria-hidden="true">üéØ</span>
                            <span>Pr√©cis</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer role="contentinfo">
        <div class="container">
            <p>&copy; 2024 DictaMed - Dict√©e m√©dicale intelligente</p>
            <p>Pour toute question ou assistance, contactez <a href="mailto:support@dictamed.fr">support@dictamed.fr</a></p>
        </div>
    </footer>

    <!-- Modal d'authentification optimis√© -->
    <div id="authModal" class="auth-modal hidden" role="dialog" aria-modal="true" aria-labelledby="authModalTitle">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <div class="auth-modal-logo">
                    <span class="logo-dicta">Dicta</span><span class="logo-med">Med</span>
                </div>
                <h2 id="authModalTitle">Connexion</h2>
                <button class="auth-modal-close" data-action="close-auth" aria-label="Fermer la modal">&times;</button>
            </div>
            
            <div class="auth-modal-body">
                <div class="auth-mode-toggle" role="tablist" aria-label="Type d'authentification">
                    <button type="button" id="modalSignInTab" class="auth-tab-btn active" role="tab" aria-selected="true" aria-controls="modalEmailAuthForm">
                        <span class="auth-tab-icon" aria-hidden="true">üîê</span>
                        Connexion
                    </button>
                    <button type="button" id="modalSignUpTab" class="auth-tab-btn" role="tab" aria-selected="false" aria-controls="modalEmailAuthForm">
                        <span class="auth-tab-icon" aria-hidden="true">‚ú®</span>
                        Inscription
                    </button>
                </div>
                
                <form id="modalEmailAuthForm" class="auth-email-form" role="tabpanel">
                    <div class="form-group-modern">
                        <label for="modalEmailInput">
                            <span class="input-icon" aria-hidden="true">üìß</span>
                            Email
                        </label>
                        <input type="email" id="modalEmailInput" placeholder="votre@email.com" required autocomplete="email" aria-describedby="emailHelp">
                    </div>
                    
                    <div class="form-group-modern">
                        <label for="modalPasswordInput">
                            <span class="input-icon" aria-hidden="true">üîí</span>
                            Mot de passe
                        </label>
                        <div class="password-input-wrapper">
                            <input type="password" id="modalPasswordInput" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password" aria-describedby="passwordHelp">
                            <button type="button" class="password-toggle" data-action="toggle-password" aria-label="Afficher le mot de passe">
                                <span class="eye-icon" aria-hidden="true">üëÅÔ∏è</span>
                            </button>
                        </div>
                        <div class="password-strength hidden" id="passwordStrength">
                            <div class="strength-bar"></div>
                            <span class="strength-text">Force du mot de passe</span>
                        </div>
                    </div>
                    
                    <div class="auth-options">
                        <label class="remember-me">
                            <input type="checkbox" id="rememberMe">
                            <span class="checkmark"></span>
                            Se souvenir de moi
                        </label>
                        <a href="#" class="forgot-password" data-action="forgot-password">Mot de passe oubli√© ?</a>
                    </div>
                    
                    <button type="submit" id="modalEmailSubmitBtn" class="btn btn-primary btn-full btn-glow" aria-describedby="submitHelp">
                        <span class="btn-text">Se connecter</span>
                        <span class="btn-icon" aria-hidden="true">‚Üí</span>
                        <div class="loading-spinner-small hidden" aria-hidden="true"></div>
                    </button>
                    
                    <div class="auth-separator" role="separator" aria-label="Ou continuer avec">
                        <span>ou continuer avec</span>
                    </div>
                    
                    <button type="button" id="modalGoogleSignInBtn" class="btn btn-google btn-full" aria-label="Se connecter avec Google">
                        <svg class="google-icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        Continuer avec Google
                    </button>
                    
                    <div id="modalAuthError" class="auth-error hidden" role="alert" aria-live="polite"></div>
                    
                    <div class="auth-footer">
                        <p class="terms-text">
                            En vous connectant, vous acceptez nos 
                            <a href="#" aria-label="Conditions d'utilisation">Conditions d'utilisation</a> et 
                            <a href="#" aria-label="Politique de confidentialit√©">Politique de confidentialit√©</a>
                        </p>
                    </div>
                </form>
                
                <!-- Profil utilisateur (affich√© si connect√©) -->
                <div id="modalUserProfile" class="user-profile-compact hidden">
                    <div class="user-info-modern">
                        <div class="user-avatar-modern" id="modalUserAvatar">
                            <div class="avatar-placeholder-modern" id="modalAvatarPlaceholder" aria-label="Avatar utilisateur">üë§</div>
                            <div class="avatar-status-indicator" aria-hidden="true"></div>
                        </div>
                        <div class="user-details-modern">
                            <h4 id="modalUserName">Utilisateur</h4>
                            <p id="modalUserEmail">email@example.com</p>
                            <span class="connection-status-modern">
                                <span class="status-dot" aria-hidden="true"></span>
                                Connect√©
                            </span>
                        </div>
                    </div>
                    <div class="user-actions-modern">
                        <button class="btn btn-outline" data-tab="mode-normal" data-action="close-after-nav" aria-label="Acc√©der au mode normal">
                            <span aria-hidden="true">üè•</span> Mode Normal
                        </button>
                        <button id="modalSignOutBtn" class="btn btn-danger" aria-label="Se d√©connecter">
                            <span aria-hidden="true">üö™</span> D√©connexion
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK v10+ Modulaire -->
    <script type="module">
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyC9XYvHxbp3VW0PCW0W7MxsjoUZE",
            authDomain: "dictamed2025.firebaseapp.com",
            projectId: "dictamed2025",
            storageBucket: "dictamed2025.firebasestorage.app",
            messagingSenderId: "242034923776",
            appId: "1:242034923776:web:bd315e890c715b1d263be5",
            measurementId: "G-1B8DZ4B73R"
        };
        
        // Charger Firebase SDK modulaire
        const loadFirebase = async () => {
            try {
                // Importer les modules Firebase
                const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
                const {
                    getAuth,
                    onAuthStateChanged,
                    signInWithEmailAndPassword,
                    createUserWithEmailAndPassword,
                    signOut,
                    sendPasswordResetEmail,
                    GoogleAuthProvider,
                    signInWithPopup
                } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js');
                
                // Initialiser Firebase
                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);
                
                // Rendre disponible globalement pour compatibilit√©
                window.firebase = {
                    app: app,
                    auth: auth,
                    // M√©thodes d'authentification
                    onAuthStateChanged: onAuthStateChanged,
                    signInWithEmailAndPassword: signInWithEmailAndPassword,
                    createUserWithEmailAndPassword: createUserWithEmailAndPassword,
                    signOut: signOut,
                    sendPasswordResetEmail: sendPasswordResetEmail,
                    GoogleAuthProvider: GoogleAuthProvider,
                    signInWithPopup: signInWithPopup
                };
                
                console.log('‚úÖ Firebase SDK modulaire initialis√© avec succ√®s');
                console.log('üìä Configur√© pour:', firebaseConfig.projectId);
                
                // Dispatcher un √©v√©nement pour informer les autres scripts
                window.dispatchEvent(new Event('firebaseReady'));
                
                return window.firebase;
                
            } catch (error) {
                console.error('‚ùå Erreur Firebase SDK modulaire:', error);
                throw error;
            }
        };
        
        // Charger Firebase imm√©diatement
        window.initFirebase = loadFirebase;
        
        // Charger automatiquement
        loadFirebase().catch(error => {
            console.error('‚ùå √âchec du chargement Firebase:', error);
        });
    </script>
    <!-- ===== ORDRE DE CHARGEMENT OPTIMIS√â DES SCRIPTS ===== -->
    
    <!-- 1. DEPENDANCES CRITIQUES EN PREMIER -->
    <script src="js/core/config.js"></script>
    <script src="js/core/utils.js"></script>
    <script src="js/core/error-handler.js"></script>
    <script src="js/core/performance-optimizer.js"></script>
    
    <!-- 2. √âTAT DE L'APPLICATION -->
    <script src="js/core/app-state.js"></script>
    
    <!-- 3. SYST√àMES FONDAMENTAUX -->
    <script src="js/components/notification.js"></script>
    <script src="js/components/loading-overlay.js"></script>
    
    <!-- 4. GESTIONNAIRE D'AUTHENTIFICATION (CRITIQUE POUR DMI) -->
    <script src="js/components/firebase-auth-manager.js"></script>
    <script src="js/components/auth-modal.js"></script>
    <script src="js/components/admin-navigation-manager.js"></script>
    
    <!-- 5. COMPOSANTS AUDIO (D√âPENDANCE CRITIQUE) -->
    <script src="js/components/audio-recorder.js"></script>
    <script src="js/components/audio-recorder-manager.js"></script>
    
    <!-- 6. SYST√àMES DE NAVIGATION ET VALIDATION -->
    <script src="js/components/navigation.js"></script>
    <script src="js/components/form-validation.js"></script>
    
    <!-- 7. SYST√àMES DE DONN√âES ET SAUVEGARDE -->
    <script src="js/components/data-sender.js"></script>
    <script src="js/components/auto-save.js"></script>
    <script src="js/components/dmi-data-sender.js"></script>
    
    <!-- 8. SYST√àMES AUXILIAIRES -->
    <script src="js/components/photo-management.js"></script>
    
    <!-- 9. MODULES D'ONGLETS (D√âPENDENT DES COMPOSANTS CI-DESSUS) -->
    <script src="js/tabs/home.js"></script>
    <script src="js/tabs/normal-mode.js"></script>
    <script src="js/tabs/test-mode.js"></script>
    
    <!-- Script de diagnostic -->
    <script src="diagnostic-debug.js"></script>
    
    <!-- Point d'entr√©e principal -->
    <script src="js/main.js"></script>
    <!-- Diagnostic Firebase Authentication -->
    <script src="firebase-auth-diagnostic.js"></script>
    
    <!-- Tests unitaires (seulement en d√©veloppement) -->
    <script src="tests/unit-tests.js"></script>

</body>
</html>